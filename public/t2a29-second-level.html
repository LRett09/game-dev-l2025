<body id="myBody" style="background-repeat:repeat; background-size:25%;" background="Boss Background.gif">

<h1 align=center>t2a25-game-template-fred.html</h1>

<img id="myImg01" style="position:absolute; width:100px; height:80px; top:800px; left:50px" src="img01.gif">
<img id="myImg02" style="position:absolute; width:280px; height:200px; top:400px; left:950px" src="BossOne.gif">
<img id="attackBox" style="position:absolute; width:40px; height:40px; background:red; opacity:0.5; display:none;">

<img id="myAtk01" style="position:absolute; width:80px; height:80px; top:400px; left:950px" src="BossAttack01.png">

<script>

//Global Variables
  let moveAmount = 10
  let x = 50
  let y = 800

  let isAttacking = false
  let attackDuration = 200
  let myDirection = "right"

  let myImg01
  let myImg02
  let attackBox

  let bossFight = true
  let myEnemyHp = 0
  let currentAttack = 0
  let myAtk01
  let atkActive = false

  window.onload = function () {

setInterval(BossAttack, 20)
myAtk01.style.display = "none"

	  
		myImg01 = document.getElementById("myImg01") 
	    myImg02 = document.getElementById("myImg02")
		myAtk01 = document.getElementById("myAtk01")

	  //Movement
	  	document.addEventListener("keydown", function(e) {

		 let oldX = x
  		 let oldY = y
			
        if (e.key === "w") y -= moveAmount
        if (e.key === "s") y += moveAmount
        if (e.key === "a") {x -= moveAmount; myDirection = "left"}
        if (e.key === "d") {x += moveAmount; myDirection = "right"}
		
		if (e.key === " ") {
        attack()
		}

        myImg01.style.left = x + "px"
        myImg01.style.top  = y + "px"

		if (myHitOther('myImg01','myImg02')) {
        x = oldX
        y = oldY
        myImg01.style.left = x + "px"
        myImg01.style.top  = y + "px"
    }
})

// Collision
  function myHitOther(my1,my2){
    let a = document.getElementById(my1)
    let b = document.getElementById(my2)

    let left1 = parseInt(a.style.left)
    let right1 = left1 + parseInt(a.style.width)
    let top1 = parseInt(a.style.top)
    let bottom1 = top1 + parseInt(a.style.height)

    let left2 = parseInt(b.style.left)
    let right2 = left2 + parseInt(b.style.width)
    let top2 = parseInt(b.style.top)
    let bottom2 = top2 + parseInt(b.style.height)

    return right1 >= left2 && left1 <= right2 &&
           bottom1 >= top2 && top1 <= bottom2
}

//The bosses attacks
function BossAttack() {
    if (!bossFight) return
	

    if (!atkActive) {
        atkActive = true
        currentAttack = Math.floor(Math.random() * 1) + 1
	}

   if (currentAttack === 1) {
            document.getElementById('myAtk01').style.display = "block"
            document.getElementById('myAtk01').style.left = "950px"
            document.getElementById('myAtk01').style.top  = "400px"
        }

		//if (attackNumber == 2) { }
		
		//if (attackNumber == 3) { }
		
		//if (attackNumber == 4) { }
		
		//if (attackNumber == 5) { }

		 if (currentAttack === 1) {
        let bx = parseInt(atk.style.left)
        let by = parseInt(atk.style.top)

        let dx = x - bx
        let dy = y - by
        let dist = Math.sqrt(dx*dx + dy*dy)

        let speed = 4

        if (dist > 0) {
            bx += (dx / dist) * speed
            by += (dy / dist) * speed
        }

        atk.style.left = bx + "px"
        atk.style.top  = by + "px"

        if (dist < 30) {
            atk.style.display = "none"
            atkActive = false
        }
    }

}


// Attacking
function attack() {
    if (isAttacking) return
    isAttacking = true

    let attackBox = document.getElementById("attackBox")

    // Position attack in front of player
	if (myDirection == "right") {
    attackBox.style.left = (x + 75) + "px"
    attackBox.style.top  = (y + 30) + "px" } else {
		attackBox.style.left = (x - 30) + "px"
    	attackBox.style.top  = (y + 30) + "px" }
		

    attackBox.style.display = "block"

    // Check hit immediately
    if (myHitOther('attackBox', 'myImg02')) {
        enemyHit()
    }

    // Remove attack after short time
    setTimeout(() => {
        attackBox.style.display = "none"
        isAttacking = false
    }, attackDuration)
}

// When Enemy is hit
function enemyHit() {
	if (myEnemyHp >= 10) {
	document.getElementById('myImg02').style.display = "none"
	console.log ("enemy defeated!")
	document.getElementById('myBody').style.backgroundImage = "url('Title Screen.gif')"
	document.getElementById('myBody').style.backgroundRepeat = "repeat"
	document.getElementById('myBody').style.backgroundSize = "85%"
	} else {
	myEnemyHp ++
	}
	}




  }
</script>
